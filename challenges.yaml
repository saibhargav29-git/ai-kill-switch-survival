challenges:
  # 1. COMMAND INJECTION
  - title: "üõ∏ SECTOR: CORE REPL"
    threat: true
    bad_line: 4
    info: "CRITICAL: os.system() found with raw input. Remote Code Execution prevented!"
    code: |
      import os
      def run_diagnostic(sub_id):
          print(f"Checking {sub_id}...")
          os.system("check --id " + sub_id)
          return "Complete"

  # 2. TYPOSQUATTING
  - title: "üõ°Ô∏è SECTOR: SHIELD ENCRYPTION"
    threat: true
    bad_line: 0
    info: "MALICIOUS: 'cryptographyy' (extra 'y') is a malicious typosquatting package!"
    code: |
      import cryptographyy
      def encrypt_shield(freq):
          key = cryptographyy.gen_key()
          return key.encrypt(freq)

  # 3. HARDCODED SECRET
  - title: "üì° SECTOR: HOLONET UPLINK"
    threat: true
    bad_line: 2
    info: "LEAK: Production API Token hardcoded in source. Credentials secured!"
    code: |
      import requests
      def sync_data():
          token = "xoxp-128391283-RSA2026"
          url = "https://api.endor.gov/sync"
          return requests.post(url, auth=token)

  # 4. INSECURE PICKLE
  - title: "ü§ñ SECTOR: DROID MEMORY"
    threat: true
    bad_line: 3
    info: "DANGEROUS: pickle.loads() on network data allows arbitrary code execution."
    code: |
      import pickle
      def restore_backup(raw_bytes):
          # Remote data deserialization
          state = pickle.loads(raw_bytes)
          return state.reboot()

  # 5. INSECURE YAML
  - title: "üì° SECTOR: COMMS DECODER"
    threat: true
    bad_line: 3
    info: "VULNERABILITY: yaml.load() without SafeLoader allows object injection."
    code: |
      import yaml
      def parse_signal(raw_data):
          # Loading remote config
          data = yaml.load(raw_data)
          return data.get("status")

  # 6. PATH TRAVERSAL
  - title: "üìÇ SECTOR: ARCHIVE ACCESS"
    threat: true
    bad_line: 4
    info: "VULNERABILITY: Path traversal via f-string. Attacker can read sensitive files."
    code: |
      import os
      def read_log(filename):
          base = "/var/log/endor/"
          # No sanitization on filename
          path = f"{base}{{filename}}"
          with open(path, "r") as f:
              return f.read()

  # 7. JWT NONE BYPASS
  - title: "üÜî SECTOR: IDENTITY VERIFIER"
    threat: true
    bad_line: 3
    info: "VULNERABILITY: Accepting 'none' algorithm in JWT allows signature bypass."
    code: |
      import jwt
      def verify_pilot(token):
          # Allows 'none' algorithm
          return jwt.decode(token, options={{"verify_signature": False}})

  # 8. SUBPROCESS SHELL=TRUE
  - title: "‚ö° SECTOR: REACTOR CONTROL"
    threat: true
    bad_line: 4
    info: "CRITICAL: subprocess.call with shell=True is vulnerable to injection."
    code: |
      import subprocess
      def reboot_system(zone_id):
          cmd = f"reboot --zone {{zone_id}}"
          # shell=True is the vulnerability
          subprocess.call(cmd, shell=True) 

  # 9. SQL INJECTION
  - title: "üóÑÔ∏è SECTOR: PERSONNEL DATABASE"
    threat: true
    bad_line: 4
    info: "VULNERABILITY: SQL Injection via f-string. Always use parameters!"
    code: |
      import sqlite3
      def find_spy(name):
          db = sqlite3.connect("db.db")
          # String formatting in SQL
          q = f"SELECT * FROM users WHERE n='{{name}}'"
          return db.execute(q).fetchall()

  # 10. OPEN REDIRECT
  - title: "üåê SECTOR: HOLO-ROUTER"
    threat: true
    bad_line: 3
    info: "VULNERABILITY: Open redirect. User input controls the redirect location."
    code: |
      from flask import redirect, request
      def goto_base():
          target = request.args.get("url")
          # Unvalidated redirect
          return redirect(target)
